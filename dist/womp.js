const Q=!0;let E=null,v=0;const y="$wc$",H="wc-wc",R=/<\/?$/g,T=/\s+([^\s]*?)="?$/g,O=/(<([a-x]*?-[a-z]*).*?)\/>/g,S=/<(?<tag>script|style|textarea|title])(?!.*?<\/\k<tag>)/gi,M=/^(?:script|style|textarea|title)$/i,D=0,N=1,P=2,k=document.createTreeWalker(document,129);class V{constructor(e,n){this.template=e,this.dependencies=n}clone(){const e=this.template.content,n=this.dependencies,o=document.importNode(e,!0);k.currentNode=o;let t=k.nextNode(),i=0,a=0,r=n[0];const c=[];for(;r!==void 0;){if(i===r.index){let l;const d=r.type;d===D?l=new W(t,t.nextSibling):d===N?l=new F(t,r):d===P&&(l=new L(t)),c.push(l),r=n[++a]}i!==r?.index&&(t=k.nextNode(),i++)}return k.currentNode=document,[o,c]}}class I{constructor(e,n,o){this.stringifiedTemplate=e,this.values=n,this.template=o}}class W{constructor(e,n){this.isNode=!0;this.isAttr=!1;this.isTag=!1;this.startNode=e,this.endNode=n}clearValue(){let e=this.startNode.nextSibling;for(;e!==this.endNode;)e.remove(),e=this.startNode.nextSibling}dispose(){this.clearValue(),this.startNode.remove(),this.endNode.remove()}}class F{constructor(e,n){this.isNode=!1;this.isAttr=!0;this.isTag=!1;this.__eventInitialized=!1;this.node=e,this.name=n.name,this.attrStructure=n.attrDynamics}updateValue(e){if(this.name==="ref"&&e.__wcRef){if(e.current=this.node,this.node._$womp){const o=this.node.onDisconnected;this.node.onDisconnected=()=>{e.current=null,o()}}return}this.name==="wc-perf"&&(this.node._$measurePerf=!0),this.node._$womp&&this.node.updateProps(this.name,e);const n=e!==Object(e);if(e===!1)this.node.removeAttribute(this.name);else if(n&&!this.name.match(/[A-Z]/))this.node.setAttribute(this.name,e);else if(this.name==="style"){let o="";const t=Object.keys(e);for(const i of t){let a=e[i],r=i.replace(/[A-Z]/g,c=>"-"+c.toLowerCase());typeof a=="number"&&(a=`${a}px`),o+=`${r}:${a};`}this.node.setAttribute(this.name,o)}}set callback(e){if(!this.__eventInitialized){const n=this.name.substring(1);this.node.addEventListener(n,this.__listener.bind(this)),this.__eventInitialized=!0}this.__callback=e}__listener(e){this.__callback&&this.__callback(e)}}class L{constructor(e){this.isNode=!1;this.isAttr=!1;this.isTag=!0;this.node=e}}class j{constructor(e){this._$wompChildren=!0;this.nodes=e}}class z{constructor(e,n){this.isArrayDependency=!0;this.dynamics=[],this.__parentDependency=n,this.addDependenciesFrom(n.startNode,e.length),this.__oldValues=$(this.dynamics,e,[])}addDependenciesFrom(e,n){let o=e,t=n;for(;t;){const i=document.createComment("?START"),a=document.createComment("?END");o.after(i),i.after(a);const r=new W(i,a);o=a,this.dynamics.push(r),t--}}checkUpdates(e){let n=e.length-this.__oldValues.length;if(n>0){let o=this.dynamics[this.dynamics.length-1]?.endNode;o||(o=this.__parentDependency.startNode),this.addDependenciesFrom(o,n)}else if(n<0)for(;n;)this.dynamics.pop().dispose(),n++;return this.__oldValues=$(this.dynamics,e,this.__oldValues),this}}const q=(s,e)=>{const{css:n}=s,{shadow:o,name:t,cssGeneration:i}=e,a=t,r={};let c=n;if(!o&&!i&&!t.startsWith("womp-context-provider")&&console.warn(`The component ${t} is not an isolated component (shadow=false) and has the cssGeneration option set to false.
This can lead to unexpected behaviors, because this component can alter other components' styles.`),i){let l=n;n.includes(":host")||(l=`${o?":host":a} {display:block;} ${n}`);{const d=[];[...l.matchAll(/.*?}([\s\S]*?){/gm)].forEach(p=>{const m=p[1].trim();m.includes(".")||d.push(m)}),d.forEach(p=>{console.warn(`The CSS selector "${p} {...}" in the component "${a}" is not enough specific: include at least one class.`)})}o||(c=c.replace(/:host/g,a)),c=c.replace(/\.(?!\d)(.*?)[\s|{|,|+|~|>]/gm,(d,p)=>{const m=`${a}__${p}`;return r[p]=m,`.${m} `})}return[c,r]},U=s=>{let e="";const n=[],o=s.length-1;let t="",i="";for(let a=0;a<o;a++){let r=s[a];if(t&&r.includes(t)&&(t=""),i&&new RegExp(`</${i}>`)&&(i=""),t||i)e+=r+y;else{T.lastIndex=0;const c=T.exec(r);if(c){const[l,d]=c,p=l[l.length-1];t=p==='"'||p==="'"?p:"",r=r.substring(0,r.length-t.length-1);let m=`${r}${y}=`;t?m+=`${t}${y}`:m+='"0"',e+=m,n.push(d)}else{if(r.match(R)){e+=r+H;continue}S.lastIndex=0;const l=S.exec(r);l?(i=l[1],e+=r+y):e+=r+`<?${y}>`}}}return e+=s[s.length-1],e=e.replace(O,"$1></$2>"),[e,n]},G=(s,e,n)=>{const o=[];k.currentNode=s.content;let t,i=0,a=0;const r=e.length;for(;(t=k.nextNode())!==null&&o.length<r;){if(t.nodeType===1){if(t.nodeName===H.toUpperCase()){const c={type:P,index:a};o.push(c)}if(t.hasAttributes()){const c=t.getAttributeNames();for(const l of c)if(l.endsWith(y)){const d=n[i++],p=t.getAttribute(l);if(p!=="0"){const m=p.split(y);for(let u=0;u<m.length-1;u++){const h={type:N,index:a,attrDynamics:p,name:d};o.push(h)}}else{const m={type:N,index:a,name:d};o.push(m)}t.removeAttribute(l)}}if(M.test(t.tagName)){const c=t.textContent.split(y),l=c.length-1;if(l>0){t.textContent="";for(let d=0;d<l;d++)t.append(c[d],document.createComment("")),k.nextNode(),o.push({type:D,index:++a});t.append(c[l],document.createComment(""))}}}else t.nodeType===8&&t.data===`?${y}`&&o.push({type:D,index:a});a++}return o},A=s=>{const[e,n]=U(s),o=document.createElement("template");o.innerHTML=e;const t=G(o,s,n);return new V(o,t)},B=s=>{let e="";const{parts:n,values:o}=s;for(let t=0;t<n.length;t++)e+=n[t],o[t]?.componentName&&(e+=o[t].componentName);return e},Z=(s,e,n)=>{const o=s!==e,t=!!n.attrStructure,a=s?._$wompChildren&&n.startNode.nextSibling!==s.nodes[0];return o||t||a},$=(s,e,n)=>{const o=[...e];for(let t=0;t<s.length;t++){const i=s[t],a=o[t],r=n[t];if(Z(a,r,i)){if(i.isNode){if(a===!1){i.clearValue();continue}if(a?._$wompHtml){const p=r?.stringifiedTemplate,m=B(a);if(r===void 0||!(m===p)){const f=A(a.parts).clone(),[g,b]=f;o[t]=new I(m,a.values,f),$(b,a.values,r?.values??r??[]);const x=i.endNode,C=i.startNode;let _=C.nextSibling;for(;_!==x;)_.remove(),_=C.nextSibling;for(_=C;g.childNodes.length;)_.after(g.childNodes[0]),_=_.nextSibling}else{const[h,f]=r.template,g=$(f,a.values,r.values);r.values=g,o[t]=r}continue}const c=a!==Object(a),l=r!==Object(r)&&r!==void 0,d=i.startNode;if(c)l?d.nextSibling?d.nextSibling.textContent=a:d.after(a):(i.clearValue(),d.after(a));else{let p=d.nextSibling,m=0,u=0;if(a._$wompChildren){const h=a.nodes;for(;u<h.length;){(!p||u===0)&&(p=d);const f=h[m];m++,p.after(f),p=p.nextSibling,u++}}else Array.isArray(a)?r?.isArrayDependency?o[t]=r.checkUpdates(a):(i.clearValue(),o[t]=new z(a,i)):console.warn(`Rendering objects is not supported. Doing a stringified version of it can rise errors.
This node will be ignored.`)}}else if(i.isAttr)if(i.name.startsWith("@"))i.callback=a;else{const l=i.attrStructure;if(l){const d=l.split(y);let p=a;for(let m=0;m<d.length-1;m++)d[m]=`${d[m]}${p}`,t++,p=o[t];t--,i.updateValue(d.join("").trim())}else i.updateValue(a)}else if(i.isTag){const c=i.node;let l=null;const d=a._$wompF,p=d?a.componentName:a;if(c.nodeName!==p.toUpperCase()){const m=c.getAttributeNames();if(d){if(c._$womp){console.error("Dynamic tags are currently not supported, unsless used to render for the first time a custom component.\nInstead, you can use conditional rendering.\n(e.g. condition ? html`<${First} />` : html`<${Second} />`).");continue}const f={};for(const b of m){const x=c.getAttribute(b);f[b]=x===""?!0:x}l=new a.class,l._$initialProps=f;const g=c.childNodes;for(;g.length;)l.appendChild(g[0])}else{l=document.createElement(p);for(const f of m)l.setAttribute(f,c.getAttribute(f))}let u=t,h=s[u];for(;h?.node===c;)h.node=l,h=s[++u],h?.name&&h?.name!=="ref"&&(l._$initialProps[h.name]=e[u]);c.replaceWith(l)}}}}return o},K=(s,e)=>{const[n,o]=q(s,e),t=document.createElement("style"),i=`${e.name}__styles`;return t.classList.add(i),t.textContent=n,e.shadow||document.body.appendChild(t),class extends HTMLElement{constructor(){super();this._$womp=!0;this.props={};this._$hooks=[];this._$measurePerf=!1;this._$initialProps={};this._$usesContext=!1;this._$hasBeenMoved=!1;this.__updating=!1;this.__oldValues=[];this.__isInitializing=!0;this.__connected=!1;this.__isInDOM=!1}static{this._$womp=!0}static{this.componentName=e.name}static _$getOrCreateTemplate(c){return this._$cachedTemplate||(this._$cachedTemplate=A(c)),this._$cachedTemplate}connectedCallback(){this.__isInDOM=!0,this.__connected||this.initElement()}disconnectedCallback(){this.__connected&&(this.__isInDOM=!1,Promise.resolve().then(()=>{this.__isInDOM?(this._$hasBeenMoved=!0,this._$usesContext&&this.requestRender()):(this.onDisconnected(),console.warn("Disconnected",this))}))}onDisconnected(){}initElement(){this.__ROOT=this,this.props={...this.props,...this._$initialProps,styles:o};const c=this.getAttributeNames();for(const _ of c){if(!this.props.hasOwnProperty(_)){const w=this.getAttribute(_);this.props[_]=w===""?!0:w}_==="wc-perf"&&(this._$measurePerf=!0)}this.props["wc-perf"]&&(this._$measurePerf=!0),this._$measurePerf&&console.time("First render "+e.name);const l=this.__ROOT.childNodes,d=[];for(;l.length;)d.push(l[0]),l[0].remove();const p=new j(d);this.props.children=p,e.shadow&&(this.__ROOT=this.attachShadow({mode:"open"}));const m=this.getRootNode();if((e.shadow||m!==document)&&!m.querySelector(`.${i}`)){const _=t.cloneNode(!0);this.__ROOT.appendChild(_)}const u=this.__callComponent(),{values:h,parts:f}=u,g=this.constructor._$getOrCreateTemplate(f),[b,x]=g.clone();this.__dynamics=x;const C=$(this.__dynamics,h,this.__oldValues);for(this.__oldValues=C;b.childNodes.length;)this.__ROOT.appendChild(b.childNodes[0]);this.__isInitializing=!1,this.__connected=!0,this._$measurePerf&&console.timeEnd("First render "+e.name)}__callComponent(){E=this,v=0;const c=s.call(this,this.props);let l=c;return(typeof c=="string"||c instanceof HTMLElement)&&(l=html`${c}`),l}requestRender(){this.__updating||(this.__updating=!0,Promise.resolve().then(()=>{this._$measurePerf&&console.time("Re-render "+e.name);const c=this.__callComponent(),l=$(this.__dynamics,c.values,this.__oldValues);this.__oldValues=l,this.__updating=!1,this._$hasBeenMoved=!1,this._$measurePerf&&console.timeEnd("Re-render "+e.name)}))}updateProps(c,l){this.props[c]!==l&&(this.props[c]=l,this.__isInitializing||(console.warn(`Updating ${c}`,this.__isInitializing),this.requestRender()))}}};export const useHook=()=>{const n=[E,v];return v++,n},useState=s=>{const[e,n]=useHook();if(!e._$hooks.hasOwnProperty(n)){const t=n;e._$hooks[t]=[s,i=>{let a=i;const r=e._$hooks[t];typeof i=="function"&&(a=i(r[0])),a!==r[0]&&(r[0]=a,e.requestRender())}]}return e._$hooks[n]},useEffect=(s,e)=>{const[n,o]=useHook();if(n._$hooks.hasOwnProperty(o)){const t=n._$hooks[o];for(let i=0;i<e.length;i++)if(t.dependencies[i]!==e[i]){typeof t.cleanupFunction=="function"&&t.cleanupFunction(),Promise.resolve().then(()=>{t.cleanupFunction=s(),t.dependencies=e});break}}else{const t={dependencies:e,callback:s,cleanupFunction:null};n._$hooks[o]=t,Promise.resolve().then(()=>{t.cleanupFunction=s()})}},useLayoutEffect=(s,e)=>{const[n,o]=useHook();if(n._$hooks.hasOwnProperty(o)){const t=n._$hooks[o];for(let i=0;i<e.length;i++)if(t.dependencies[i]!==e[i]){typeof t.cleanupFunction=="function"&&t.cleanupFunction(),t.cleanupFunction=s(),t.dependencies=e;break}}else{const t={dependencies:e,callback:s,cleanupFunction:null};n._$hooks[o]=t,t.cleanupFunction=s()}},useRef=(s=null)=>{const[e,n]=useHook();return e._$hooks.hasOwnProperty(n)||(e._$hooks[n]={current:s,__wcRef:!0}),e._$hooks[n]},useCallback=s=>{const[e,n]=useHook();return e._$hooks.hasOwnProperty(n)||(e._$hooks[n]=s),e._$hooks[n]};const Y=()=>{let s=0;return()=>{const[e,n]=useHook();return e._$hooks.hasOwnProperty(n)||(e._$hooks[n]=`:r${s}:`,s++),e._$hooks[n]}};export const useId=Y(),useMemo=(s,e)=>{const[n,o]=useHook();if(!n._$hooks.hasOwnProperty(o))n._$hooks[o]={value:s(),dependencies:e};else{const i=n._$hooks[o];for(let a=0;a<e.length;a++)if(i.dependencies[a]!==e[a]){i.dependencies=e,i.value=s();break}}return n._$hooks[o].value},useReducer=(s,e)=>{const[n,o]=useHook(),t=o;if(!n._$hooks.hasOwnProperty(t)){const r=[e,c=>{const l=n._$hooks[t][0],d=s(l,c),p=Object.keys(d);for(const u of p)if(d[u]!==l[u]){n.requestRender();break}const m={...l,...d};n._$hooks[o][0]=m}];n._$hooks[o]=r}return n._$hooks[o]},useExposed=s=>{const e=E,n=Object.keys(s);for(const o of n)e[o]=s[o]};const J=()=>{let s=0;return e=>{const n=`womp-context-provider-${s}`;s++;const o=defineWomp(({children:i})=>{const r=useRef(new Set);return useExposed({subscribers:r}),r.current.forEach(c=>c.requestRender()),html`${i}`},{name:n,cssGeneration:!1});return{name:n,Provider:o,default:e,subscribers:new Set}}};export const createContext=J(),useContext=s=>{const[e,n]=useHook();if(e._$usesContext=!0,!e._$hooks.hasOwnProperty(n)||e._$hasBeenMoved){let t=e;const i=s.name.toUpperCase();for(;t&&t.nodeName!==i&&t!==document.body;)t instanceof ShadowRoot?t=t.host:t=t.parentNode;const a=e._$hooks[n]?.node;if(t&&t!==document.body){t.subscribers.current.add(e);const r=e.onDisconnected;e.onDisconnected=()=>{t.subscribers.current.delete(e),r()}}else a?(console.warn(`The element ${e.tagName} doens't have access to the Context ${s.name} because is no longer a child of it.`),a.subscribers.current.delete(e)):e.isConnected&&console.warn(`The element ${e.tagName} doens't have access to the Context ${s.name}. The default value will be returned instead.`);e._$hooks[n]={node:t,value:t&&t!==document.body?t.props.value:s.default}}const o=e._$hooks[n].node;return o?o.props.value:s.default};export function html(s,...e){const n=[],o=s.length-1;for(let t=0;t<o;t++)s[t].endsWith("</")||n.push(e[t]);return{parts:s,values:n,_$wompHtml:!0}}export const wompDefaultOptions={shadow:!1,name:"",cssGeneration:!0};export function defineWomp(s,e){s.css||(s.css="");const n={...wompDefaultOptions,...e||{}};if(!n.name){let t=s.name.replace(/.[A-Z]/g,i=>`${i[0]}-${i[1].toLowerCase()}`).toLowerCase();t.includes("-")||(t+="-womp"),n.name=t}s.componentName=n.name,s._$wompF=!0;const o=K(s,n);return s.class=o,customElements.define(n.name,o),s}export const jsx=(s,e)=>{const n={parts:[],values:[],_$wompHtml:!0};if(s===Fragment){if(e.children.parts)n.parts.push(...e.children.parts),n.values.push(...e.children.values);else if(Array.isArray(e.children)){for(const o of e.children)n.parts.push(...o.parts),n.values.push(...o.values),n.values.push(!1);n.values.pop()}}else{let o=s;s._$wompF&&(o=s.componentName);let t=`<${o}`;const i=Object.keys(e);for(const r of i){if(r==="children")break;const c=r.match(/on([A-Z].*)/);c?t+=` @${c[1].toLowerCase()}=`:t+=` ${r}=`,n.parts.push(t),n.values.push(e[r]),t=""}t+=">",n.parts.push(t);const a=e.children;if(a&&a.parts){if(e.children.parts)n.values.push(!1),n.parts.push(...e.children.parts),n.values.push(...e.children.values),n.values.push(!1);else if(Array.isArray(e.children))for(const r of e.children)n.values.push(!1),n.parts.push(...r.parts),n.values.push(...r.values),n.values.push(!1)}else n.values.push(a);t=`</${o}>`,n.parts.push(t)}return n},Fragment="wc-fragment";
