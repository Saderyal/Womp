const te=!1;let S=null,C=0;const f="$wc$",v="wc-wc",O=/<\/?$/g,w=/\s+([^\s]*?)="?$/g,I=/(<([a-z]*-[a-z]*).*?)\/?>/gs,D=/<(?<tag>script|style|textarea|title])(?!.*?<\/\k<tag>)/gi,V=/^(?:script|style|textarea|title)$/i,x=0,E=1,H=2,N=typeof global<"u",P=N?{createTreeWalker(){}}:document,_=P.createTreeWalker(P,129);class L{constructor(e,t){this.template=e,this.dependencies=t}clone(){const e=this.template.content,t=this.dependencies,s=document.importNode(e,!0);_.currentNode=s;let o=_.nextNode(),i=0,r=0,a=t[0];const l=[];for(;a!==void 0;){if(i===a.index){let c;const d=a.type;d===x?c=new $(o,o.nextSibling):d===E?c=new z(o,a):d===H&&(c=new j(o)),l.push(c),a=t[++r]}i!==a?.index&&(o=_.nextNode(),i++)}return _.currentNode=document,[s,l]}}class F{constructor(e,t){this.values=e.values,this.parts=e.parts,this.template=t}}class ${constructor(e,t){this.isNode=!0;this.isAttr=!1;this.isTag=!1;this.startNode=e,this.endNode=t}clearValue(){let e=this.startNode.nextSibling;for(;e&&e!==this.endNode;)e.remove(),e=this.startNode.nextSibling}dispose(){this.clearValue(),this.startNode.remove(),this.endNode&&this.endNode.remove()}}class z{constructor(e,t){this.isNode=!1;this.isAttr=!0;this.isTag=!1;this.__eventInitialized=!1;this.node=e,this.name=t.name,this.attrStructure=t.attrDynamics}updateValue(e){if(this.name==="ref"&&e.__wcRef){if(e.current=this.node,this.node._$wompo){const o=this.node.onDisconnected;this.node.onDisconnected=()=>{e.current=null,o()}}return}const t=this.node._$wompo;t&&this.node.updateProp(this.name,e);const s=e!==Object(e);if(e===!1)this.node.removeAttribute(this.name);else if(s&&(!this.name.match(/[A-Z]/)||this.node.nodeName==="svg"))this.node.setAttribute(this.name,e);else if(this.name==="style"){let o="";const i=Object.keys(e);for(const r of i){let a=e[r],l=r.replace(/[A-Z]/g,c=>"-"+c.toLowerCase());typeof a=="number"&&(a=`${a}px`),o+=`${l}:${a};`}this.node.setAttribute(this.name,o)}this.name==="title"&&t&&this.node.removeAttribute(this.name)}set callback(e){if(!this.__eventInitialized){const t=this.name.substring(1);this.node.addEventListener(t,this.__listener.bind(this)),this.__eventInitialized=!0}this.__callback=e}__listener(e){this.__callback&&this.__callback(e)}}class j{constructor(e){this.isNode=!1;this.isAttr=!1;this.isTag=!0;this.node=e}}class q{constructor(e){this._$wompoChildren=!0;this.nodes=e}}class U{constructor(e,t){this.isArrayDependency=!0;this.dynamics=[],this.__parentDependency=t,this.addDependenciesFrom(t.startNode,e.length),this.__oldValues=k(this.dynamics,e,[])}addDependenciesFrom(e,t){let s=e,o=t;for(;o;){const i=document.createComment("?START"),r=document.createComment("?END");s.after(i),i.after(r);const a=new $(i,r);s=r,this.dynamics.push(a),o--}}checkUpdates(e){let t=e.length-this.__oldValues.length;if(t>0){let s=this.dynamics[this.dynamics.length-1]?.endNode;s||(s=this.__parentDependency.startNode),this.addDependenciesFrom(s,t)}else if(t<0)for(;t;)this.dynamics.pop().dispose(),t++;return this.__oldValues=k(this.dynamics,e,this.__oldValues),this}}const B=(n,e)=>{const{css:t}=n,{shadow:s,name:o,cssModule:i}=e,r=o,a={};let l=t;return i&&(t.includes(":host")||(l=`${s?":host":r} {display:block;} ${t}`),s||(l=l.replace(/:host/g,r)),l=l.replace(/\.(?!\d)([_a-zA-Z0-9-]+)/gm,(c,d)=>{const p=`${r}__${d}`;return a[d]=p,`.${p}`})),[l,a]},Z=n=>{let e="";const t=[],s=n.length-1;let o="",i="";for(let r=0;r<s;r++){let a=n[r];if(o&&a.includes(o)&&(o=""),i&&new RegExp(`</${i}>`)&&(i=""),o||i)e+=a+f;else{w.lastIndex=0;const l=w.exec(a);if(l){const[c,d]=l,p=c[c.length-1];o=p==='"'||p==="'"?p:"",a=a.substring(0,a.length-o.length-1);let m=`${a}${f}=`;o?m+=`${o}${f}`:m+='"0"',e+=m,t.push(d)}else{if(a.match(O)){e+=a+v;continue}D.lastIndex=0;const c=D.exec(a);c?(i=c[1],e+=a+f):e+=a+`<?${f}>`}}}return e+=n[n.length-1],e=e.replace(I,(r,a,l)=>r.endsWith("/>")?`${a}></${l}>`:r),[e,t]},K=(n,e,t)=>{const s=[];_.currentNode=n.content;let o,i=0,r=0;const a=e.length;for(;(o=_.nextNode())!==null&&s.length<a;){if(o.nodeType===1){if(o.nodeName===v.toUpperCase()){const l={type:H,index:r};s.push(l)}if(o.hasAttributes()){const l=o.getAttributeNames();for(const c of l)if(c.endsWith(f)){const d=t[i++],p=o.getAttribute(c);if(p!=="0"){const m=p.split(f);for(let u=0;u<m.length-1;u++){const h={type:E,index:r,attrDynamics:p,name:d};s.push(h)}}else{const m={type:E,index:r,name:d};s.push(m)}o.removeAttribute(c)}}if(V.test(o.tagName)){const l=o.textContent.split(f),c=l.length-1;if(c>0){o.textContent="";for(let d=0;d<c;d++)o.append(l[d],document.createComment("")),_.nextNode(),s.push({type:x,index:++r});o.append(l[c],document.createComment(""))}}}else o.nodeType===8&&o.data===`?${f}`&&s.push({type:x,index:r});r++}return s},W=n=>{const[e,t]=Z(n.parts),s=document.createElement("template");s.innerHTML=e;const o=K(s,n.parts,t);return new L(s,o)},G=(n,e)=>{if(!n||!e)return!1;const t=n.parts,s=e.parts;if(t.length!==s?.length)return!1;const o=n.values,i=e.values;for(let r=0;r<t.length;r++)if(t[r]!==s[r]||o[r]?._$wompoF&&(!i[r]?._$wompoF||o[r].componentName!==i[r].componentName))return!1;return!0},Y=(n,e,t)=>{const s=n!==e,o=!!t.attrStructure,r=n?._$wompoChildren&&t.startNode.nextSibling!==n.nodes[0];return s||o||r},T=(n,e,t,s,o)=>{const i=e.node;let r=null;const a=n._$wompoF,l=a?n.componentName:n;if(i.nodeName!==l.toUpperCase()){const c=i.getAttributeNames();if(a){const m={};for(const h of c){const g=i.getAttribute(h);m[h]=g===""?!0:g}r=new n.class,r._$initialProps=m;const u=i.childNodes;for(;u.length;)r.appendChild(u[0])}else{r=document.createElement(l);for(const m of c)r.setAttribute(m,i.getAttribute(m))}let d=t,p=s[d];for(;p?.node===i;)p.node=r,p=s[++d],p?.name&&p?.name!=="ref"&&(r._$initialProps[p.name]=o[d]);return i.replaceWith(r),r}},k=(n,e,t)=>{const s=[...e];for(let o=0;o<n.length;o++){const i=n[o],r=s[o],a=t[o];if(Y(r,a,i)){if(i.isNode){if(r===!1||r===void 0||r===null){i.clearValue();continue}if(r?._$wompoHtml){const p=G(r,a);if(a===void 0||!p){const u=W(r).clone(),[h,g]=u;s[o]=new F(r,u),k(g,r.values,a?.values??a??[]);const M=i.endNode,b=i.startNode;let y=b.nextSibling;for(;y!==M;)y.remove(),y=b.nextSibling;for(y=b;h.childNodes.length;)y.after(h.childNodes[0]),y=y.nextSibling}else{const[m,u]=a.template,h=k(u,r.values,a.values);a.values=h,s[o]=a}continue}const l=r!==Object(r),c=a!==Object(a)&&a!==void 0,d=i.startNode;if(l)c?d.nextSibling?d.nextSibling.textContent=r:d.after(r):(i.clearValue(),d.after(r));else{let p=d.nextSibling,m=0,u=0;if(r._$wompoChildren){a&&!a?._$wompoChildren&&i.clearValue();const h=r.nodes;for(;u<h.length;){(!p||u===0)&&(p=d);const g=h[m];m++,p.after(g),p=p.nextSibling,u++}}else Array.isArray(r)&&(a?.isArrayDependency?s[o]=a.checkUpdates(r):(i.clearValue(),s[o]=new U(r,i)))}}else if(i.isAttr)if(i.name.startsWith("@"))i.callback=r;else{const c=i.attrStructure;if(c){const d=c.split(f);let p=r;for(let m=0;m<d.length-1;m++)d[m]=`${d[m]}${p}`,o++,p=s[o];o--,i.updateValue(d.join("").trim())}else i.updateValue(r)}else if(i.isTag)if(r._$wompoLazy){const c=i.node,d=A(c);d&&(d.addSuspense?d.addSuspense(c):(d.loadingComponents=new Set,d.loadingComponents.add(c)),c.suspense=d),r().then(p=>{const m=T(p,i,o,n,e);d&&d.removeSuspense(c,m)});continue}else T(r,i,o,n,e)}}return s},J=(n,e)=>{const{generatedCSS:t,styles:s}=n.options,o=new CSSStyleSheet;return o.replaceSync(t),class extends HTMLElement{constructor(){super();this._$wompo=!0;this.props={};this.hooks=[];this._$measurePerf=!1;this._$initialProps={};this._$usesContext=!1;this._$hasBeenMoved=!1;this._$layoutEffects=[];this.__updating=!1;this.__oldValues=[];this.__isInitializing=!0;this.__connected=!1;this.__isInDOM=!1}static{this._$wompo=!0}static{this.componentName=e.name}static _$getOrCreateTemplate(a){return this._$cachedTemplate||(this._$cachedTemplate=W(a)),this._$cachedTemplate}connectedCallback(){this.__isInDOM=!0,!this.__connected&&this.isConnected&&this.initElement()}disconnectedCallback(){this.__connected&&(this.__isInDOM=!1,Promise.resolve().then(()=>{if(this.__isInDOM)this._$hasBeenMoved=!0,this._$usesContext&&this.requestRender();else{this.onDisconnected();for(const a of this.hooks)a?.cleanupFunction&&a.cleanupFunction()}}))}onDisconnected(){}initElement(){this.__ROOT=this,this.props={...this.props,...this._$initialProps,styles:s};const a=this.getAttributeNames();for(const p of a)if(!this.props.hasOwnProperty(p)){const m=this.getAttribute(p);this.props[p]=m===""?!0:m}const l=this.__ROOT.childNodes,c=[];for(;l.length;)c.push(l[0]),l[0].remove();const d=new q(c);if(this.props.children=d,e.shadow&&!this.shadowRoot&&(this.__ROOT=this.attachShadow({mode:"open"})),e.shadow)this.__ROOT.adoptedStyleSheets=[o];else{const p=this.getRootNode();p.adoptedStyleSheets=[...p.adoptedStyleSheets,o]}this.__render(),this.__isInitializing=!1,this.__connected=!0}__callComponent(){S=this,C=0;const a=n.call(this,this.props);let l=a;return(typeof a=="string"||a instanceof HTMLElement)&&(l=html`${a}`),l}__render(){try{const a=this.__callComponent();if(a==null){this.remove();return}const l=this.constructor;if(this.__isInitializing){const c=l._$getOrCreateTemplate(a),[d,p]=c.clone();this.__dynamics=p;const m=k(this.__dynamics,a.values,this.__oldValues);for(this.__oldValues=m,this.__isInitializing||(this.__ROOT.innerHTML="");d.childNodes.length;)this.__ROOT.appendChild(d.childNodes[0])}else{const c=k(this.__dynamics,a.values,this.__oldValues);this.__oldValues=c}for(;this._$layoutEffects.length;){const c=this._$layoutEffects.pop();c.cleanupFunction=c.callback()}}catch(a){console.error(a)}}requestRender(){this.__updating||(this.__updating=!0,Promise.resolve().then(()=>{this.__render(),this.__updating=!1,this._$hasBeenMoved=!1}))}updateProp(a,l){this.props[a]!==l&&(this.props[a]=l,this.__isInitializing||this.requestRender())}}};export const useHook=()=>{const t=[S,C];return C++,t},useState=n=>{const[e,t]=useHook();if(!e)return typeof n=="function"?[n(),()=>{}]:[n,()=>{}];if(!e.hooks.hasOwnProperty(t)){const o=t;e.hooks[o]=[typeof n=="function"?n():n,i=>{let r=i;const a=e.hooks[o];typeof i=="function"&&(r=i(a[0])),r!==a[0]&&(a[0]=r,e.requestRender())}]}return e.hooks[t]},useEffect=(n,e=null)=>{const[t,s]=useHook();if(t.hooks.hasOwnProperty(s)){const o=t.hooks[s];if(e!==null){for(let i=0;i<e.length;i++)if(o.dependencies[i]!==e[i]){typeof o.cleanupFunction=="function"&&o.cleanupFunction(),Promise.resolve().then(()=>{o.cleanupFunction=n(),o.dependencies=e});break}}else Promise.resolve().then(()=>{o.cleanupFunction=n(),o.dependencies=e})}else{const o={dependencies:e,callback:n,cleanupFunction:null};t.hooks[s]=o,Promise.resolve().then(()=>{o.cleanupFunction=n()})}},useLayoutEffect=(n,e=null)=>{const[t,s]=useHook();if(t.hooks.hasOwnProperty(s)){const o=t.hooks[s];if(e!==null){for(let i=0;i<e.length;i++)if(o.dependencies[i]!==e[i]){typeof o.cleanupFunction=="function"&&o.cleanupFunction(),o.dependencies=e,o.callback=n,t._$layoutEffects.push(o);break}}else t._$layoutEffects.push(o)}else{const o={dependencies:e,callback:n,cleanupFunction:null};t.hooks[s]=o,t._$layoutEffects.push(o)}},useRef=(n=null)=>{const[e,t]=useHook();return e.hooks.hasOwnProperty(t)||(e.hooks[t]={current:n,__wcRef:!0}),e.hooks[t]},useCallback=(n,e=[])=>{const[t,s]=useHook();if(!t.hooks.hasOwnProperty(s))t.hooks[s]={dependencies:e,value:n};else{const i=t.hooks[s];for(let r=0;r<e.length;r++)if(i.dependencies[r]!==e[r]){i.dependencies=e,i.value=n;break}}return t.hooks[s].value};const Q=()=>{let n=0;return()=>{const[e,t]=useHook();return e.hooks.hasOwnProperty(t)||(e.hooks[t]=`:w${n}:`,n++),e.hooks[t]}};export const useId=Q(),useMemo=(n,e)=>{const[t,s]=useHook();if(!t.hooks.hasOwnProperty(s))t.hooks[s]={value:n(),dependencies:e};else{const i=t.hooks[s];for(let r=0;r<e.length;r++)if(i.dependencies[r]!==e[r]){i.dependencies=e,i.value=n();break}}return t.hooks[s].value},useReducer=(n,e)=>{const[t,s]=useHook(),o=s;if(!t.hooks.hasOwnProperty(o)){const a=[e,l=>{const c=t.hooks[o][0],d=n(c,l);let p=d;typeof c=="object"&&!Array.isArray(c)&&c!==null&&(p={...c,...d}),t.hooks[s][0]=p,p!==c&&t.requestRender()}];t.hooks[s]=a}return t.hooks[s]},useExposed=n=>{const e=S,t=Object.keys(n);for(const s of t)e[s]=n[s]};const R=(n,e,t)=>{const[s,o]=n;e&&e.addSuspense(s),s.hooks[o].value=null,t().then(r=>{s.requestRender(),e.removeSuspense(s),s.hooks[o].value=r}).catch(r=>console.error(r))};export const useAsync=(n,e)=>{const[t,s]=useHook(),o=A(t);if(!t.hooks.hasOwnProperty(s))t.hooks[s]={dependencies:e,value:null},R([t,s],o,n);else{const i=t.hooks[s];let r=!1;for(let a=0;a<e.length;a++)if(i.dependencies[a]!==e[a]){i.dependencies=e,r=!0;break}r&&R([t,s],o,n)}return t.hooks[s].value};const X=()=>{let n=0;return e=>{const t=`wompo-context-provider-${n}`;n++;const s=defineWompo(({children:i})=>{const a=useRef(new Set);return useExposed({subscribers:a}),a.current.forEach(l=>l.requestRender()),html`${i}`},{name:t,cssModule:!1});return{name:t,Provider:s,default:e,subscribers:new Set}}};export const createContext=X(),useContext=n=>{const[e,t]=useHook();if(e._$usesContext=!0,!e.hooks.hasOwnProperty(t)||e._$hasBeenMoved){let o=e;const i=n.name.toUpperCase();for(;o&&o.nodeName!==i&&o!==document.body;)o instanceof ShadowRoot?o=o.host:o=o.parentNode;const r=e.hooks[t]?.node;if(o&&o!==document.body){o.subscribers.current.add(e);const a=e.onDisconnected;e.onDisconnected=()=>{o.subscribers.current.delete(e),a()}}else r&&r.subscribers.current.delete(e);e.hooks[t]={node:o}}const s=e.hooks[t].node;return s?s.props.value:n.default};export function html(n,...e){const t=[],s=n.length-1;if(N)t.push(...e);else for(let o=0;o<s;o++)n[o].endsWith("</")||t.push(e[o]);return{parts:n,values:t,_$wompoHtml:!0}}export const wompoDefaultOptions={shadow:!1,name:"",cssModule:!0},registeredComponents={};export function defineWompo(n,e){n.css||(n.css="");const t={...wompoDefaultOptions,...e||{}};if(!t.name){let i=n.name.replace(/.[A-Z]/g,r=>`${r[0]}-${r[1].toLowerCase()}`).toLowerCase();i.includes("-")||(i+="-wompo"),t.name=i}n.componentName=t.name,n._$wompoF=!0;const[s,o]=B(n,t);if(n.css=s,n.options={generatedCSS:s,styles:o,shadow:t.shadow},!N){const i=J(n,t);n.class=i,customElements.define(t.name,i)}return registeredComponents[t.name]=n,n}export const lazy=n=>{let e=null;async function t(){if(!e)try{return e=(await n()).default,e}catch(s){return console.error(s),ee}return e}return t._$wompoLazy=!0,t};const A=n=>{let e=n;for(;e&&e.nodeName!==Suspense.componentName.toUpperCase();)e.parentNode===null&&e.host?e=e.host:e=e?.parentNode;return e};let ee;export function Suspense({children:n,fallback:e}){return this.loadingComponents||(this.loadingComponents=useRef(new Set).current),this.addSuspense=t=>{this.loadingComponents.size||this.requestRender(),this.loadingComponents.add(t)},this.removeSuspense=(t,s=null)=>{if(this.loadingComponents.delete(t),s){for(let o=0;o<n.nodes.length;o++)if(n.nodes[o]===t){n.nodes[o]=s;break}}this.loadingComponents.size||this.requestRender()},this.loadingComponents.size?html`${e}`:html`${n}`}defineWompo(Suspense,{name:"wompo-suspense"});
